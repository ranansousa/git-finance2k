unit uFrmPrincipal;

interface

uses
  Winapi.Windows, uMD5, Winapi.Messages, System.SysUtils, System.UITypes, System.Variants, System.Classes, Vcl.Graphics, uUtil, uVarGlobais, Vcl.Controls, Vcl.Forms, Vcl.Dialogs, FireDAC.Phys.ADSWrapper, FireDAC.UI.Intf, FireDAC.VCLUI.Error, FireDAC.VCLUI.Wait, FireDAC.Phys, FireDAC.stan.Def, Registry, FireDAC.Phys.IBBase, FireDAC.Phys.FB, FireDAC.Comp.UI, FireDAC.stan.Intf, uFrmRegistraBaseDados, FireDAC.Phys.ADS, Vcl.StdCtrls, Vcl.ExtCtrls, Vcl.Buttons, FireDAC.Phys.IBWrapper, Vcl.Samples.Gauges, Vcl.ComCtrls,
  Vcl.Samples.Spin, wininet, Winsock, IdSSL, IdSSLOpenSSL, IdMessage, Organizacao, IdAttachmentFile, IdTCPClient, IdExplicitTLSClientServerBase, IdMessageClient, IdSMTPBase, uLogin, IdTCPConnection, IdSMTP, jpeg, IdBaseComponent, IdComponent, IdHTTP, FireDAC.stan.Option, FireDAC.stan.Error, FireDAC.Phys.Intf, FireDAC.stan.Pool, FireDAC.stan.Async, FireDAC.stan.Param, FireDAC.DatS, FireDAC.DApt.Intf, FireDAC.DApt, FireDAC.Comp.Client, Data.DB, FireDAC.Comp.DataSet, Vcl.Mask, VCLUnZip, VCLZip, FireDAC.Phys.FBDef,
  IdAntiFreezeBase, Vcl.IdAntiFreeze, frxClass, udmConexao, uDMOrganizacao, udmMegaContabil, uDMUsuarioConsulta, ACBrBase, uDmExportaFinance, uDMContasPagar, Vcl.Imaging.pngimage, Vcl.Grids, Vcl.DBGrids, frxDBSet, uFrmManutencao, Vcl.Menus, uFrmBackup, uFrmRegistro, uFrmServidorEmail, uDMServerMail, System.ImageList, Vcl.ImgList, uFrmImportacao, uFrmRelatorios, uFrmExportacao, uFrmSincronizaMega, uFrmTeste, uFrmUpdate, udmCombos, RxDBCtrl, frxCrypt, UMostraErros,uFrmAlteraTituloPagar,uFrmAlteraTituloReceber,
  uFrameBDTables, udmManutencao, uFrameOrganizacoes, uFrameEstado,
  uFrameGeneric, uFrameCidade, uFrameEndereco, uFrameBairro;

type
  TFrmPrincipal = class(TForm)

    menuPrincipal: TMainMenu;
    Pagar1: TMenuItem;
    Receber1: TMenuItem;
    esouraria1: TMenuItem;
    Relatorios1: TMenuItem;
    Parametros1: TMenuItem;
    Utilitarios1: TMenuItem;
    Sobre1: TMenuItem;
    Backup1: TMenuItem;
    Exportao1: TMenuItem;
    Registro1: TMenuItem;
    Info1: TMenuItem;
    Atualizar1: TMenuItem;
    ServidorEmail1: TMenuItem;
    IdAntiFreeze1: TIdAntiFreeze;
    Importao1: TMenuItem;
    menuitemRelFinancas: TMenuItem;
    cbxOrganizacoes: TComboBox;
    menuItemManutencao: TMenuItem;
    stat1: TStatusBar;
    menuItemTPNovo: TMenuItem;
    menuItemSincMega: TMenuItem;
    lblPathSGBD: TLabel;
    edtLogin: TEdit;
    lbl1: TLabel;
    lbl2: TLabel;
    edtPassword: TEdit;
    lbl3: TLabel;
    btnLogin: TBitBtn;
    cbxUsuario: TComboBox;
    btnZoom: TButton;
    lblBoasVindas: TLabel;
    menuItemTPAltDoc: TMenuItem;
    mniTRAltDoc: TMenuItem;
    img1: TImage;
    mmoMain: TMemo;
    pnlMain: TPanel;

    procedure Backup1Click(Sender: TObject);
    procedure Registro1Click(Sender: TObject);
    procedure ServidorEmail1Click(Sender: TObject);
    procedure Importao1Click(Sender: TObject);
    procedure menuitemRelFinancasClick(Sender: TObject);
    procedure Exportao1Click(Sender: TObject);
    procedure btnTesteClick(Sender: TObject);
    procedure btnSelectOrgClick(Sender: TObject);
    procedure FormCreate(Sender: TObject);
    procedure cbxOrganizacoesChange(Sender: TObject);
    procedure Atualizar1Click(Sender: TObject);
    procedure acessoMenu(value: Boolean);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    procedure menuItemManutencaoClick(Sender: TObject);
    procedure menuItemTPNovoClick(Sender: TObject);
    procedure menuItemSincMegaClick(Sender: TObject);
    procedure cbxUsuarioChange(Sender: TObject);
    procedure btnLoginClick(Sender: TObject);
    procedure Zoom(Sender: TObject);
    procedure menuItemTPAltDocClick(Sender: TObject);
    procedure cbxUsuarioClick(Sender: TObject);
    procedure mniTRAltDocClick(Sender: TObject);
    procedure btn1Click(Sender: TObject);
    procedure alignPanelLogin(Sender: TObject);
    procedure FormKeyDown(Sender: TObject; var Key: Word; Shift: TShiftState);



  private
    { Private declarations }
    numberError: string;
    pid: string;
    BDConectado, userValidado: Boolean;
    FsListaIdOrganizacoes: TStringList;
    FsListaIdUsuarios: TStringList;
    FsListaIdEstados: TStringList;
    FsListaIdCidades: TStringList;
    FsListaIdBairros: TStringList;

    ajustaFormLigado : Boolean;
    procedure inicializarDM(Sender: TObject);
    procedure freeAndNilDM(Sender: TObject);
    procedure AjustaForm;
  public
    { Public declarations }
    orgAtual: TOrganizacao;
  end;

var
  FrmPrincipal: TFrmPrincipal;

implementation

{$R *.dfm}

uses
  uDMRelatorioExportacaoMega, uFrmContasPagar;

procedure TFrmPrincipal.Backup1Click(Sender: TObject);
begin
  try
    frmBackup := TFrmBackup.Create(Self);
    frmBackup.ShowModal;
    FreeAndNil(frmBackup);

  except
    on e: Exception do
      ShowMessage(e.Message + sLineBreak + 'Contate o administrador!');
  end;

end;

procedure TFrmPrincipal.acessoMenu(value: Boolean);
var
  poItem: TMenuItem;
begin
  begin
    for poItem in menuPrincipal.Items do
    begin
      poItem.Enabled := value;
    end;
  end;

end;


procedure TFrmPrincipal.btn1Click(Sender: TObject);
begin

//frmEnd1.frmCidade1.createComboAll('CIDADE','CIDADE','CIDADE', frmEnd1.frmCidade1.cbbcombo , FsListaIdCidades );

end;

procedure TFrmPrincipal.btnLoginClick(Sender: TObject);
var
  loMostraErros: TFMostraErros;
begin
  loMostraErros := TFMostraErros.Create(Self);
  try

//    loMostraErros.caption := 'Aviso';
//
//    loMostraErros.Add('vá pra porra');
//    loMostraErros.Add('vá pra porra 1');
//    loMostraErros.Add('vá pra porra 2');
//    loMostraErros.Add('vá pra porra 3');
//    loMostraErros.Add('vá pra porra 4');
//    loMostraErros.Add('vá pra porra 5');
//
//
//    if loMostraErros.Count > 0 then begin
//      loMostraErros.ShowModal;
//    end;
  finally
    FreeAndNil(loMostraErros);
  end;

  userValidado := False;

  if dmUsuarioConsulta.validarLogin(StrToInt(pid), edtLogin.Text, edtPassword.Text) then
  begin
    dmOrganizacao.obterDataServidor;  // seta a data atual originada do server de banco de dados
    edtLogin.Enabled := False;
    edtPassword.Enabled := False;
    edtLogin.Text := '';
    edtPassword.Text := '';

    lblBoasVindas.Visible := True;
    lblBoasVindas.Caption := 'Seja bem vindo(a). Selecione uma organização para trabalhar.';
    cbxOrganizacoes.Visible := True;
    cbxOrganizacoes.Enabled := True;
        //cbxOrganizacoes.Focused := True;
//    lblSelectOrg.Visible := True; //  lblSelectOrg.Caption := 'Selecione uma organização.';

    pnlMain.Align := alClient;
  end
  else
  begin
    cbxOrganizacoes.Enabled := False;
    //lblSelectOrg.Visible := False;
    lblBoasVindas.Visible := False;
    edtPassword.Text := '';
    ShowMessage('Login/Senha incorretos.');
  end;

end;

procedure TFrmPrincipal.btnSelectOrgClick(Sender: TObject);
var
  pid: string;
  indice: Integer;
begin
  if (cbxOrganizacoes.ItemIndex > (-1)) then
  begin
    indice := (cbxOrganizacoes.ItemIndex - 1);
    pid := FsListaIdOrganizacoes[indice];
  end;
  if (dmConexao.Conn.Connected) then
  begin
    dmOrganizacao.carregarDadosEmpresa(pid);
    pid := dmOrganizacao.qryDadosEmpresa.FieldByName('ID_ORGANIZACAO').AsString;
    uUtil.TOrgAtual.setId(pid);
  end;
end;

procedure TFrmPrincipal.btnTesteClick(Sender: TObject);
begin
  numberError := '1031';
  try

    if not (uUtil.TOrgAtual.getId = '') then
    begin
      frmTeste := TfrmTeste.Create(Self);
      frmTeste.ShowModal;
      FreeAndNil(frmTeste);
    end
    else
    begin
      acessoMenu(false);
      MessageDlg('Impossível apresentar dados da Organização...', mtWarning, [mbOK], 0);
      cbxOrganizacoes.SetFocus;
    end;

  except
    on e: Exception do
      ShowMessage(e.Message + sLineBreak + 'Contate o suporte. Informe erro: ' + numberError);
  end;

end;

procedure TFrmPrincipal.Zoom(Sender: TObject);
begin
  if not ajustaFormLigado then
  begin
    ajustaFormLigado := True;
    AjustaForm;
    btnZoom.Caption := 'Ligado';
  end
  else
  begin
    ajustaFormLigado := False;
     AjustaForm;
    btnZoom.Caption := 'Desligado';
  end;
end;

procedure TFrmPrincipal.cbxOrganizacoesChange(Sender: TObject);
var
  cnpj, pid: string;
  indice: Integer;
begin

  try
    acessoMenu(false);

    if (cbxOrganizacoes.ItemIndex > (-1)) then
    begin

      indice := (cbxOrganizacoes.ItemIndex);
      pid := FsListaIdOrganizacoes[indice];

      if not (dmConexao.Conn.Connected) then
      begin
        dmConexao.conectarBanco;
      end;

      if (dmConexao.Conn.Connected) then
      begin
        dmOrganizacao.carregarDadosEmpresa(pid);
        pid := dmOrganizacao.qryDadosEmpresa.FieldByName('ID_ORGANIZACAO').AsString;
        cnpj := Trim(dmOrganizacao.qryDadosEmpresa.FieldByName('CNPJ').AsString);
    //setando dados da organizacao selecionada
        uUtil.TOrgAtual.setId(pid);
        uUtil.TOrgAtual.setCNPJ(cnpj);
        uUtil.TOrgAtual.setFantasia(dmOrganizacao.qryDadosEmpresa.FieldByName('FANTASIA').AsString);
        uUtil.TOrgAtual.setRazaoSocial(dmOrganizacao.qryDadosEmpresa.FieldByName('RAZAO_SOCIAL').AsString);
        uUtil.TOrgAtual.setSistemaContabil(dmOrganizacao.qryDadosEmpresa.FieldByName('SISTEMA_CONTABIL').AsString);


        //esconde o login
              pnlMain.Visible := true;
              lblBoasVindas.Visible := False;
              img1.Visible := False;
              lbl1.Visible := False;
              lbl2.Visible := False;
              lbl3.Visible := False;


//    lblPathSGBD.Caption := 'PATH BANCO ' + uUtil.TOrgAtual.getPathSGBD;
        stat1.Panels[1].Text := 'USER : > ' + TUserAtual.getNameUser;
        stat1.Panels[2].Text := 'ORG  : > ' + uUtil.TOrgAtual.getFantasia ;
        stat1.Panels[3].Text := 'DATA : > ' + FormatDateTime('dd/mm/yyyy', uUtil.getDataServer);
        stat1.Panels[4].Text := 'BANCO DE DADOS : > ' + uUtil.TOrgAtual.getPathSGBD ;
        stat1.Panels[5].Text := '';

        if not (uUtil.TOrgAtual.getSistemaContabil.Empty) then begin
        stat1.Panels[5].Text := 'SISTEMA CONTÁBIL : > ' + uUtil.TOrgAtual.getSistemaContabil;
        end;


        if not (pid = '') then
        begin
          acessoMenu(true); // libera o menu principal
        end
        else
        begin
          acessoMenu(false);
          stat1.Panels[1].Text := '';
          stat1.Panels[2].Text := ' ';
          stat1.Panels[3].Text := 'DATA : > ' + FormatDateTime('dd/mm/yyyy', dmOrganizacao.obterDataServidor);
          stat1.Panels[5].Text := '';

        end;

      end;

    end
    else
    begin
      acessoMenu(false);
      MessageDlg('Dados incorretos...', mtWarning, [mbOK], 0);
    end;
  except
    on e: Exception do
      MessageDlg('Problemas ao selecionar uma empresa...', mtWarning, [mbOK], 0);
  end;

end;

procedure TFrmPrincipal.cbxUsuarioChange(Sender: TObject);
var
  cnpj: string;
  indice: Integer;
begin
    //desenvolver
  acessoMenu(false);
  cbxOrganizacoes.Enabled := False;
  uUtil.TUserAtual.setId('');
  userValidado := False;
  btnLogin.Enabled := False;

  if (cbxUsuario.ItemIndex > (-1)) then
  begin
    //obter usuario selecionado
    indice := (cbxUsuario.ItemIndex);
    pid := FsListaIdUsuarios[indice];

    if not (indice = 0 ) then begin

     dmUsuarioConsulta.obterUsuarioPorID(StrToInt(pid));
     //libera os botoes de login e senha
      edtLogin.Enabled := True;
      edtPassword.Enabled := True;
      btnLogin.Enabled := True;

    end
    else
    begin
      ShowMessage('Usuário não localizado... Selecione um usuário...');
    end;

  end;

end;

procedure TFrmPrincipal.cbxUsuarioClick(Sender: TObject);
begin
if( cbxUsuario.ItemIndex < 0) then begin

   ShowMessage('Seleção inválida!!!!');
end;
end;

procedure TFrmPrincipal.Exportao1Click(Sender: TObject);
begin
  numberError := '1032';
  try
    frmExportacao := TfrmExportacao.Create(Self);
    frmExportacao.ShowModal;
    FreeAndNil(frmExportacao);

  except
    on e: Exception do
      ShowMessage(e.Message + sLineBreak + 'Contate o suporte. Informe erro: ' + numberError);
  end;
end;

procedure TFrmPrincipal.FormClose(Sender: TObject; var Action: TCloseAction);
begin
//freeAndNilDM(Self);
//Action := Cafree;
//lblPathSGBD.Caption := '';
  uUtil.LimpaTela(Self);

end;

procedure TFrmPrincipal.FormCreate(Sender: TObject);
var
alignTop :Integer;
begin
  uUtil.LimpaTela(Self);
  stat1.Panels[0].Text := 'Versão: ' + GetVersionInfo(Application.ExeName);
  ajustaFormLigado :=False;
  inicializarDM(Self);
//  acessoMenu(false);
  edtLogin.Enabled := False;
  edtPassword.Enabled := False;
  lblPathSGBD.Caption := '';
  lbl2.Caption := 'Usuário';
  lbl1.Caption := 'Login';
  lbl3.Caption := 'Senha';
  lblBoasVindas.Visible := False;
  acessoMenu(false);
  btnZoom.Visible := False;
  cbxOrganizacoes.Visible := False;
  pnlMain.Visible := false;
  alignPanelLogin(Self);

//  cbxOrganizacoes.Enabled := False;
   if not BDConectado then begin
      if not (Assigned(frmRegistraBaseDados)) then
         begin
             frmRegistraBaseDados := TfrmRegistraBaseDados.Create(Self);
             frmRegistraBaseDados.ShowModal;
             FreeAndNil(frmRegistraBaseDados);
         end;

   end;


  if BDConectado then
  begin
    if dmOrganizacao.carregarOrganizacoes then
    begin
      dmCombos.listaOrganizacao(cbxOrganizacoes, FsListaIdOrganizacoes);
    end;

    if dmUsuarioConsulta.carregarUsuarios then
    begin
      dmCombos.listaUsuario(cbxUsuario, FsListaIdUsuarios);
    end;
  end ;



  if dmConexao.obterHostONLINE then
  begin
       mmoMain.Clear;
    if not dmConexao.qryEstacoesConectadas.Eof then
    begin

//     mmoMain.Text :=  dmConexao.qryEstacoesConectadas.FieldByName('PROTOCOLO').AsString;
//     mmoMain.Text :=  dmConexao.qryEstacoesConectadas.FieldByName('ENDERECO').AsString;
//     mmoMain.Text := ' LISTA ESTAÇÔES CONECTADAS AO BANCO DE DADOS  ';
     mmoMain.Lines.Add(IntToStr(dmConexao.qryEstacoesConectadas.RecordCount));
     mmoMain.Lines.Add('ESTACÃO CONECTADA   >>> ' + dmConexao.qryEstacoesConectadas.FieldByName('ENDERECO').AsString);
     Application.ProcessMessages;

    end;
  end;




//  frmEstado1.createComboAll('ESTADO','DESCRICAO',frmEstado1.cbbcombo, FsListaIdEstados);

end;

procedure TFrmPrincipal.FormKeyDown(Sender: TObject; var Key: Word;
  Shift: TShiftState);
begin
  if Key = VK_F10 then begin
  if not (Assigned(frmRegistraBaseDados)) then
         begin
             frmRegistraBaseDados := TfrmRegistraBaseDados.Create(Self);
             frmRegistraBaseDados.ShowModal;
             FreeAndNil(frmRegistraBaseDados);
          end;
  end;
end;

procedure TFrmPrincipal.Importao1Click(Sender: TObject);
begin
  numberError := '1033';
  try
    frmImportar := TfrmImportar.Create(Self);
    frmImportar.ShowModal;
    FreeAndNil(frmImportar);

  except
    on e: Exception do
      ShowMessage(e.Message + sLineBreak + 'Contate o suporte. Informe erro: ' + numberError);
  end;
end;

procedure TFrmPrincipal.menuItemManutencaoClick(Sender: TObject);
begin
  numberError := '1038';

  try
    frmManutencao := TfrmManutencao.Create(Self);
    frmManutencao.ShowModal;
    FreeAndNil(frmManutencao);

  except
    on e: Exception do
      ShowMessage(e.Message + sLineBreak + 'Contate o suporte. Informe erro: ' + numberError);
  end;

end;

procedure TFrmPrincipal.menuitemRelFinancasClick(Sender: TObject);
begin
  numberError := '1034';
  try
    frmRelatorios := TfrmRelatorios.Create(Self);
    frmRelatorios.ShowModal;
    FreeAndNil(frmRelatorios);

  except
    on e: Exception do
      ShowMessage(e.Message + sLineBreak + 'Contate o administrador!');
  end;

end;

procedure TFrmPrincipal.menuItemSincMegaClick(Sender: TObject);
begin
  numberError := '1050';
  try
    frmSincronizaMega := TfrmSincronizaMega.Create(self);
    frmSincronizaMega.ShowModal;
    FreeAndNil(frmSincronizaMega);
  except
    on e: Exception do
      ShowMessage(e.Message + sLineBreak + 'Contate o suporte. Informe erro: ' + numberError);
  end;
end;

procedure TFrmPrincipal.menuItemTPNovoClick(Sender: TObject);
begin
  numberError := '1040';

  frmContasPagar := TfrmContasPagar.Create(Self);
  frmContasPagar.ShowModal;
  FreeAndNil(frmContasPagar);

end;

procedure TFrmPrincipal.Registro1Click(Sender: TObject);
begin
  numberError := '1035';
  try
    frmRegistro := TfrmRegistro.Create(Self);
    frmRegistro.ShowModal;
    FreeAndNil(frmRegistro);

  except
    on e: Exception do
      ShowMessage(e.Message + sLineBreak + 'Contate o suporte. Informe erro: ' + numberError);
  end;

end;

procedure TFrmPrincipal.ServidorEmail1Click(Sender: TObject);
begin
  numberError := '1036';
  try
    frmServidorEmail := TfrmServidorEmail.Create(Self);
    frmServidorEmail.ShowModal;
    FreeAndNil(frmServidorEmail);

  except
    on e: Exception do
      ShowMessage(e.Message + sLineBreak + 'Contate o suporte. Informe erro: ' + numberError);
  end;

end;


procedure TFrmPrincipal.Atualizar1Click(Sender: TObject);
begin
  numberError := '1037';
  try
    frmUpdate := TfrmUpdate.Create(Self);
    frmUpdate.ShowModal;
    FreeAndNil(frmUpdate);

  except
    on e: Exception do
      ShowMessage(e.Message + sLineBreak + 'Contate o suporte. Informe erro: ' + numberError);
  end;
end;

procedure TFrmPrincipal.inicializarDM(Sender: TObject);
begin

  if not (Assigned(dmConexao)) then
  begin
    dmConexao := TdmConexao.Create(Self);
    BDConectado :=False;

    try
    BDConectado := dmConexao.conectarBanco;

    except
     on E: Exception do
      ShowMessage(' '+ e.Message);
     end;
  end;

  if not (Assigned(dmManutencao)) then
  begin
    dmManutencao := TdmManutencao.Create(Self);
  end;

  if not (Assigned(dmOrganizacao)) then
  begin
    dmOrganizacao := TdmOrganizacao.Create(Self);
  end;

  if not (Assigned(dmCombos)) then
  begin
    dmCombos := TdmCombos.Create(Self);
  end;

  if not (Assigned(dmContasPagar)) then
  begin
    dmContasPagar := TdmContasPagar.Create(Self);
  end;

  if not (Assigned(dmUsuarioConsulta)) then
  begin
    dmUsuarioConsulta := TdmUsuarioConsulta.Create(Self);
  end;

end;

procedure TFrmPrincipal.freeAndNilDM(Sender: TObject);
begin

  if (Assigned(dmConexao)) then
  begin
    FreeAndNil(dmConexao);
  end;

  if (Assigned(dmContasPagar)) then
  begin
    FreeAndNil(dmContasPagar);
  end;

  if (Assigned(dmOrganizacao)) then
  begin
    FreeAndNil(dmOrganizacao);
  end;

  if (Assigned(dmUsuarioConsulta)) then
  begin
    FreeAndNil(dmUsuarioConsulta);
  end;

  if (Assigned(dmMegaContabil)) then
  begin
    FreeAndNil(dmMegaContabil);
  end;

  if (Assigned(dmExportaFinance)) then
  begin
    FreeAndNil(dmExportaFinance);
  end;

  if (Assigned(dmContasPagar)) then
  begin
    FreeAndNil(dmContasPagar);
  end;

  if (Assigned(frmTeste)) then
  begin
    FreeAndNil(frmTeste);
  end;

  if (Assigned(dmCombos)) then
  begin
    FreeAndNil(dmCombos);
  end;

end;


procedure TFrmPrincipal.AjustaForm;
Const
nTamOriginal = 1024; // Será o 100% da escala
Var
nEscala : Double; // Vai me dar o percentual de Transformação escalar
nPorcento : Integer; // Vai me dar em percentual inteiro o valor
begin
With FrmPrincipal do
begin
      if nTamOriginal <> Screen.Width then
      begin
        nEscala := ((Screen.Width-nTamOriginal)/nTamOriginal);
        nPorcento := Round((nEscala*100) + 100);
        Self.Width := Round(Self.Width * (nEscala+1));
        Self.Height := Round(Self.Height * (nEscala+1));
        Self.ScaleBy(nPorcento,100);
      end;
end;
end;

procedure TFrmPrincipal.alignPanelLogin(Sender: TObject);
var
alignTop :Integer;
begin
   alignTop         := Trunc((Self.Height - img1.Height)/2);
   btnZoom.Left     := Trunc(Self.Width/2);
   img1.Left        := Trunc((Self.Width - img1.Width)/2);
   img1.Top         := Trunc((Self.Height - img1.Height)/2);
   btnLogin.Top     := Trunc((alignTop + 65 ));

   lbl1.Left        := Trunc(img1.Left + 90);
   lbl2.Left        := Trunc(img1.Left + 90);
   lbl3.Left        := Trunc(img1.Left + 90);
   cbxUsuario.Left  := Trunc(lbl1.Left + lbl1.Width + 20);
   edtLogin.Left    := Trunc(lbl1.Left + lbl1.Width + 20);
   edtPassword.Left := Trunc(lbl1.Left + lbl1.Width + 20);
   btnLogin.Left    := Trunc(cbxUsuario.Left + (cbxUsuario.Width + 4) )   ;

   lbl2.Top         := Trunc((alignTop +  65 ));
   lbl1.Top         := Trunc((alignTop +  95 ));
   lbl3.Top         := Trunc((alignTop + 125 ));
   cbxUsuario.Top   := Trunc((alignTop +  65 ));
   edtLogin.Top     := lbl1.Top;
   edtPassword.Top  := lbl3.Top;

   cbxOrganizacoes.Top := alignTop + (img1.Height - 40) ;
   lblBoasVindas.Top   :=cbxOrganizacoes.Top - 25;
   btnZoom.Top         :=cbxOrganizacoes.Top + 20;



end;

procedure TFrmPrincipal.mniTRAltDocClick(Sender: TObject);
begin

numberError := 'ALT-TR-1044';
  try
    frmAlteraNumDocTR := TfrmAlteraNumDocTR.Create(Self);
    frmAlteraNumDocTR.ShowModal;
    FreeAndNil(frmAlteraNumDocTR);

  except
    on e: Exception do
      ShowMessage(e.Message + sLineBreak + 'Contate o suporte. Informe erro: ' + numberError);
  end;

end;

procedure TFrmPrincipal.menuItemTPAltDocClick(Sender: TObject);
begin

numberError := 'ALT-TP-1045';
  try
    frmAlteraNumDocTP := TfrmAlteraNumDocTP.Create(Self);
    frmAlteraNumDocTP.ShowModal;
    FreeAndNil(frmAlteraNumDocTP);

  except
    on e: Exception do
      ShowMessage(e.Message + sLineBreak + 'Contate o suporte. Informe erro: ' + numberError);
  end;

end;

end.


